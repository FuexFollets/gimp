/* LIGMA - The GNU Image Manipulation Program
 * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

/* NOTE: This file is auto-generated by pdbgen.pl. */

#include "config.h"

#include "stamp-pdbgen.h"

#include <cairo.h>

#include <gegl.h>

#include <gdk-pixbuf/gdk-pixbuf.h>

#include "libligmabase/ligmabase.h"
#include "libligmacolor/ligmacolor.h"

#include "libligmabase/ligmabase.h"

#include "pdb-types.h"

#include "core/ligmachannel-combine.h"
#include "core/ligmachannel.h"
#include "core/ligmaimage.h"
#include "core/ligmaparamspecs.h"

#include "ligmapdb.h"
#include "ligmaprocedure.h"
#include "internal-procs.h"

#include "ligma-intl.h"


static LigmaValueArray *
channel_new_invoker (LigmaProcedure         *procedure,
                     Ligma                  *ligma,
                     LigmaContext           *context,
                     LigmaProgress          *progress,
                     const LigmaValueArray  *args,
                     GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gint width;
  gint height;
  const gchar *name;
  gdouble opacity;
  LigmaRGB color;
  LigmaChannel *channel = NULL;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  width = g_value_get_int (ligma_value_array_index (args, 1));
  height = g_value_get_int (ligma_value_array_index (args, 2));
  name = g_value_get_string (ligma_value_array_index (args, 3));
  opacity = g_value_get_double (ligma_value_array_index (args, 4));
  ligma_value_get_rgb (ligma_value_array_index (args, 5), &color);

  if (success)
    {
      LigmaRGB rgb_color = color;

      rgb_color.a = opacity / 100.0;
      channel = ligma_channel_new (image, width, height, name, &rgb_color);

      if (! channel)
        success = FALSE;
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_object (ligma_value_array_index (return_vals, 1), channel);

  return return_vals;
}

static LigmaValueArray *
channel_new_from_component_invoker (LigmaProcedure         *procedure,
                                    Ligma                  *ligma,
                                    LigmaContext           *context,
                                    LigmaProgress          *progress,
                                    const LigmaValueArray  *args,
                                    GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gint component;
  const gchar *name;
  LigmaChannel *channel = NULL;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  component = g_value_get_enum (ligma_value_array_index (args, 1));
  name = g_value_get_string (ligma_value_array_index (args, 2));

  if (success)
    {
      if (ligma_image_get_component_format (image, component) != NULL)
        channel = ligma_channel_new_from_component (image,
                                                   component, name, NULL);

      if (channel)
        ligma_item_set_visible (LIGMA_ITEM (channel), FALSE, FALSE);
      else
        success = FALSE;
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_object (ligma_value_array_index (return_vals, 1), channel);

  return return_vals;
}

static LigmaValueArray *
channel_copy_invoker (LigmaProcedure         *procedure,
                      Ligma                  *ligma,
                      LigmaContext           *context,
                      LigmaProgress          *progress,
                      const LigmaValueArray  *args,
                      GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaChannel *channel;
  LigmaChannel *channel_copy = NULL;

  channel = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      LigmaImage *image  = ligma_item_get_image (LIGMA_ITEM (channel));
      gint       width  = ligma_image_get_width  (image);
      gint       height = ligma_image_get_height (image);

      if (ligma_item_get_width  (LIGMA_ITEM (channel)) == width &&
          ligma_item_get_height (LIGMA_ITEM (channel)) == height)
        {
          channel_copy = LIGMA_CHANNEL (ligma_item_duplicate (LIGMA_ITEM (channel),
                                                            LIGMA_TYPE_CHANNEL));

          if (! channel_copy)
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_object (ligma_value_array_index (return_vals, 1), channel_copy);

  return return_vals;
}

static LigmaValueArray *
channel_combine_masks_invoker (LigmaProcedure         *procedure,
                               Ligma                  *ligma,
                               LigmaContext           *context,
                               LigmaProgress          *progress,
                               const LigmaValueArray  *args,
                               GError               **error)
{
  gboolean success = TRUE;
  LigmaChannel *channel1;
  LigmaChannel *channel2;
  gint operation;
  gint offx;
  gint offy;

  channel1 = g_value_get_object (ligma_value_array_index (args, 0));
  channel2 = g_value_get_object (ligma_value_array_index (args, 1));
  operation = g_value_get_enum (ligma_value_array_index (args, 2));
  offx = g_value_get_int (ligma_value_array_index (args, 3));
  offy = g_value_get_int (ligma_value_array_index (args, 4));

  if (success)
    {
      if (ligma_item_is_attached (LIGMA_ITEM (channel1)))
        ligma_channel_push_undo (channel1, _("Combine Masks"));

      ligma_channel_combine_mask (channel1, channel2, operation, offx, offy);
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
channel_get_show_masked_invoker (LigmaProcedure         *procedure,
                                 Ligma                  *ligma,
                                 LigmaContext           *context,
                                 LigmaProgress          *progress,
                                 const LigmaValueArray  *args,
                                 GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaChannel *channel;
  gboolean show_masked = FALSE;

  channel = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      show_masked = ligma_channel_get_show_masked (channel);
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_boolean (ligma_value_array_index (return_vals, 1), show_masked);

  return return_vals;
}

static LigmaValueArray *
channel_set_show_masked_invoker (LigmaProcedure         *procedure,
                                 Ligma                  *ligma,
                                 LigmaContext           *context,
                                 LigmaProgress          *progress,
                                 const LigmaValueArray  *args,
                                 GError               **error)
{
  gboolean success = TRUE;
  LigmaChannel *channel;
  gboolean show_masked;

  channel = g_value_get_object (ligma_value_array_index (args, 0));
  show_masked = g_value_get_boolean (ligma_value_array_index (args, 1));

  if (success)
    {
      ligma_channel_set_show_masked (channel, show_masked);
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
channel_get_opacity_invoker (LigmaProcedure         *procedure,
                             Ligma                  *ligma,
                             LigmaContext           *context,
                             LigmaProgress          *progress,
                             const LigmaValueArray  *args,
                             GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaChannel *channel;
  gdouble opacity = 0.0;

  channel = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      opacity = ligma_channel_get_opacity (channel) * 100;
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_double (ligma_value_array_index (return_vals, 1), opacity);

  return return_vals;
}

static LigmaValueArray *
channel_set_opacity_invoker (LigmaProcedure         *procedure,
                             Ligma                  *ligma,
                             LigmaContext           *context,
                             LigmaProgress          *progress,
                             const LigmaValueArray  *args,
                             GError               **error)
{
  gboolean success = TRUE;
  LigmaChannel *channel;
  gdouble opacity;

  channel = g_value_get_object (ligma_value_array_index (args, 0));
  opacity = g_value_get_double (ligma_value_array_index (args, 1));

  if (success)
    {
      ligma_channel_set_opacity (channel, opacity / 100.0, TRUE);
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
channel_get_color_invoker (LigmaProcedure         *procedure,
                           Ligma                  *ligma,
                           LigmaContext           *context,
                           LigmaProgress          *progress,
                           const LigmaValueArray  *args,
                           GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaChannel *channel;
  LigmaRGB color = { 0.0, 0.0, 0.0, 1.0 };

  channel = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      ligma_channel_get_color (channel, &color);
      ligma_rgb_set_alpha (&color, 1.0);
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    ligma_value_set_rgb (ligma_value_array_index (return_vals, 1), &color);

  return return_vals;
}

static LigmaValueArray *
channel_set_color_invoker (LigmaProcedure         *procedure,
                           Ligma                  *ligma,
                           LigmaContext           *context,
                           LigmaProgress          *progress,
                           const LigmaValueArray  *args,
                           GError               **error)
{
  gboolean success = TRUE;
  LigmaChannel *channel;
  LigmaRGB color;

  channel = g_value_get_object (ligma_value_array_index (args, 0));
  ligma_value_get_rgb (ligma_value_array_index (args, 1), &color);

  if (success)
    {
      LigmaRGB rgb_color = color;

      rgb_color.a = channel->color.a;
      ligma_channel_set_color (channel, &rgb_color, TRUE);
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

void
register_channel_procs (LigmaPDB *pdb)
{
  LigmaProcedure *procedure;

  /*
   * ligma-channel-new
   */
  procedure = ligma_procedure_new (channel_new_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-new");
  ligma_procedure_set_static_help (procedure,
                                  "Create a new channel.",
                                  "This procedure creates a new channel with the specified width, height, name, opacity and color.\n"
                                  "The new channel still needs to be added to the image, as this is not automatic. Add the new channel with 'ligma-image-insert-channel'. Other attributes, such as channel visibility, should be set with explicit procedure calls.\n"
                                  "The channel's contents are undefined initially.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image to which to add the channel",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("width",
                                                 "width",
                                                 "The channel width",
                                                 1, LIGMA_MAX_IMAGE_SIZE, 1,
                                                 LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("height",
                                                 "height",
                                                 "The channel height",
                                                 1, LIGMA_MAX_IMAGE_SIZE, 1,
                                                 LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_string ("name",
                                                       "name",
                                                       "The channel name",
                                                       FALSE, FALSE, FALSE,
                                                       NULL,
                                                       LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_double ("opacity",
                                                    "opacity",
                                                    "The channel opacity",
                                                    0, 100, 0,
                                                    LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_rgb ("color",
                                                    "color",
                                                    "The channel compositing color",
                                                    FALSE,
                                                    NULL,
                                                    LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_channel ("channel",
                                                            "channel",
                                                            "The newly created channel",
                                                            FALSE,
                                                            LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-new-from-component
   */
  procedure = ligma_procedure_new (channel_new_from_component_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-new-from-component");
  ligma_procedure_set_static_help (procedure,
                                  "Create a new channel from a color component",
                                  "This procedure creates a new channel from a color component.\n"
                                  "The new channel still needs to be added to the image, as this is not automatic. Add the new channel with 'ligma-image-insert-channel'. Other attributes, such as channel visibility, should be set with explicit procedure calls.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Shlomi Fish <shlomif@iglu.org.il>",
                                         "Shlomi Fish",
                                         "2005");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image to which to add the channel",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_enum ("component",
                                                  "component",
                                                  "The image component",
                                                  LIGMA_TYPE_CHANNEL_TYPE,
                                                  LIGMA_CHANNEL_RED,
                                                  LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_string ("name",
                                                       "name",
                                                       "The channel name",
                                                       FALSE, FALSE, FALSE,
                                                       NULL,
                                                       LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_channel ("channel",
                                                            "channel",
                                                            "The newly created channel",
                                                            FALSE,
                                                            LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-copy
   */
  procedure = ligma_procedure_new (channel_copy_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-copy");
  ligma_procedure_set_static_help (procedure,
                                  "Copy a channel.",
                                  "This procedure copies the specified channel and returns the copy.\n"
                                  "The new channel still needs to be added to the image, as this is not automatic. Add the new channel with 'ligma-image-insert-channel'.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel to copy",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_channel ("channel-copy",
                                                            "channel copy",
                                                            "The newly copied channel",
                                                            FALSE,
                                                            LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-combine-masks
   */
  procedure = ligma_procedure_new (channel_combine_masks_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-combine-masks");
  ligma_procedure_set_static_help (procedure,
                                  "Combine two channel masks.",
                                  "This procedure combines two channel masks. The result is stored in the first channel.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel1",
                                                        "channel1",
                                                        "The channel1",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel2",
                                                        "channel2",
                                                        "The channel2",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_enum ("operation",
                                                  "operation",
                                                  "The selection operation",
                                                  LIGMA_TYPE_CHANNEL_OPS,
                                                  LIGMA_CHANNEL_OP_ADD,
                                                  LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("offx",
                                                 "offx",
                                                 "x offset between upper left corner of channels: (second - first)",
                                                 G_MININT32, G_MAXINT32, 0,
                                                 LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("offy",
                                                 "offy",
                                                 "y offset between upper left corner of channels: (second - first)",
                                                 G_MININT32, G_MAXINT32, 0,
                                                 LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-get-show-masked
   */
  procedure = ligma_procedure_new (channel_get_show_masked_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-get-show-masked");
  ligma_procedure_set_static_help (procedure,
                                  "Get the composite method of the specified channel.",
                                  "This procedure returns the specified channel's composite method. If it is TRUE, then the channel is composited with the image so that masked regions are shown. Otherwise, selected regions are shown.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_boolean ("show-masked",
                                                         "show masked",
                                                         "The channel composite method",
                                                         FALSE,
                                                         LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-set-show-masked
   */
  procedure = ligma_procedure_new (channel_set_show_masked_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-set-show-masked");
  ligma_procedure_set_static_help (procedure,
                                  "Set the composite method of the specified channel.",
                                  "This procedure sets the specified channel's composite method. If it is TRUE, then the channel is composited with the image so that masked regions are shown. Otherwise, selected regions are shown.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_boolean ("show-masked",
                                                     "show masked",
                                                     "The new channel composite method",
                                                     FALSE,
                                                     LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-get-opacity
   */
  procedure = ligma_procedure_new (channel_get_opacity_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-get-opacity");
  ligma_procedure_set_static_help (procedure,
                                  "Get the opacity of the specified channel.",
                                  "This procedure returns the specified channel's opacity.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_double ("opacity",
                                                        "opacity",
                                                        "The channel opacity",
                                                        0, 100, 0,
                                                        LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-set-opacity
   */
  procedure = ligma_procedure_new (channel_set_opacity_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-set-opacity");
  ligma_procedure_set_static_help (procedure,
                                  "Set the opacity of the specified channel.",
                                  "This procedure sets the specified channel's opacity.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_double ("opacity",
                                                    "opacity",
                                                    "The new channel opacity",
                                                    0, 100, 0,
                                                    LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-get-color
   */
  procedure = ligma_procedure_new (channel_get_color_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-get-color");
  ligma_procedure_set_static_help (procedure,
                                  "Get the compositing color of the specified channel.",
                                  "This procedure returns the specified channel's compositing color.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_rgb ("color",
                                                        "color",
                                                        "The channel compositing color",
                                                        FALSE,
                                                        NULL,
                                                        LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-channel-set-color
   */
  procedure = ligma_procedure_new (channel_set_color_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-channel-set-color");
  ligma_procedure_set_static_help (procedure,
                                  "Set the compositing color of the specified channel.",
                                  "This procedure sets the specified channel's compositing color.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Spencer Kimball & Peter Mattis",
                                         "Spencer Kimball & Peter Mattis",
                                         "1995-1996");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_channel ("channel",
                                                        "channel",
                                                        "The channel",
                                                        FALSE,
                                                        LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_rgb ("color",
                                                    "color",
                                                    "The new channel compositing color",
                                                    FALSE,
                                                    NULL,
                                                    LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);
}
