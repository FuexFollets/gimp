/* LIGMA - The GNU Image Manipulation Program
 * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

/* NOTE: This file is auto-generated by pdbgen.pl. */

#include "config.h"

#include "stamp-pdbgen.h"

#include <cairo.h>

#include <gegl.h>

#include <gdk-pixbuf/gdk-pixbuf.h>

#include "libligmacolor/ligmacolor.h"

#include "libligmabase/ligmabase.h"

#include "pdb-types.h"

#include "core/ligmaimage-color-profile.h"
#include "core/ligmaimage.h"
#include "core/ligmaparamspecs.h"

#include "ligmapdb.h"
#include "ligmaprocedure.h"
#include "internal-procs.h"

#include "ligma-intl.h"


static LigmaValueArray *
image_get_color_profile_invoker (LigmaProcedure         *procedure,
                                 Ligma                  *ligma,
                                 LigmaContext           *context,
                                 LigmaProgress          *progress,
                                 const LigmaValueArray  *args,
                                 GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gint num_bytes = 0;
  guint8 *profile_data = NULL;

  image = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      LigmaColorProfile *profile;

      profile = ligma_image_get_color_profile (image);

      if (profile)
        {
          const guint8 *data;
          gsize         length;

          data = ligma_color_profile_get_icc_profile (profile, &length);

          profile_data = g_memdup2 (data, length);
          num_bytes = length;
        }
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    {
      g_value_set_int (ligma_value_array_index (return_vals, 1), num_bytes);
      ligma_value_take_uint8_array (ligma_value_array_index (return_vals, 2), profile_data, num_bytes);
    }

  return return_vals;
}

static LigmaValueArray *
image_get_effective_color_profile_invoker (LigmaProcedure         *procedure,
                                           Ligma                  *ligma,
                                           LigmaContext           *context,
                                           LigmaProgress          *progress,
                                           const LigmaValueArray  *args,
                                           GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gint num_bytes = 0;
  guint8 *profile_data = NULL;

  image = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      LigmaColorProfile *profile;

      profile = ligma_color_managed_get_color_profile (LIGMA_COLOR_MANAGED (image));

      if (profile)
        {
          const guint8 *data;
          gsize         length;

          data = ligma_color_profile_get_icc_profile (profile, &length);

          profile_data = g_memdup2 (data, length);
          num_bytes = length;
        }
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    {
      g_value_set_int (ligma_value_array_index (return_vals, 1), num_bytes);
      ligma_value_take_uint8_array (ligma_value_array_index (return_vals, 2), profile_data, num_bytes);
    }

  return return_vals;
}

static LigmaValueArray *
image_set_color_profile_invoker (LigmaProcedure         *procedure,
                                 Ligma                  *ligma,
                                 LigmaContext           *context,
                                 LigmaProgress          *progress,
                                 const LigmaValueArray  *args,
                                 GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  gint num_bytes;
  const guint8 *color_profile;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  num_bytes = g_value_get_int (ligma_value_array_index (args, 1));
  color_profile = ligma_value_get_uint8_array (ligma_value_array_index (args, 2));

  if (success)
    {
      if (color_profile)
        {
          LigmaColorProfile *profile;

          profile = ligma_color_profile_new_from_icc_profile (color_profile,
                                                             num_bytes,
                                                             error);

          if (profile)
            {
              success = ligma_image_assign_color_profile (image, profile,
                                                         progress, error);
              g_object_unref (profile);
            }
          else
            success = FALSE;
        }
      else
        {
          success = ligma_image_assign_color_profile (image, NULL,
                                                     progress, error);
        }
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_set_color_profile_from_file_invoker (LigmaProcedure         *procedure,
                                           Ligma                  *ligma,
                                           LigmaContext           *context,
                                           LigmaProgress          *progress,
                                           const LigmaValueArray  *args,
                                           GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  GFile *file;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  file = g_value_get_object (ligma_value_array_index (args, 1));

  if (success)
    {
      if (file)
        {
          LigmaColorProfile *profile;

          profile = ligma_color_profile_new_from_file (file, error);

          if (profile)
            {
              success = ligma_image_assign_color_profile (image, profile,
                                                         progress, error);
              g_object_unref (profile);
            }
          else
            success = FALSE;
        }
      else
        {
          success = ligma_image_assign_color_profile (image, NULL,
                                                     progress, error);
        }
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_get_simulation_profile_invoker (LigmaProcedure         *procedure,
                                      Ligma                  *ligma,
                                      LigmaContext           *context,
                                      LigmaProgress          *progress,
                                      const LigmaValueArray  *args,
                                      GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gint num_bytes = 0;
  guint8 *profile_data = NULL;

  image = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      LigmaColorProfile *profile;

      profile = ligma_image_get_simulation_profile (image);

      if (profile)
        {
          const guint8 *data;
          gsize         length;

          data = ligma_color_profile_get_icc_profile (profile, &length);

          profile_data = g_memdup2 (data, length);
          num_bytes = length;
        }
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    {
      g_value_set_int (ligma_value_array_index (return_vals, 1), num_bytes);
      ligma_value_take_uint8_array (ligma_value_array_index (return_vals, 2), profile_data, num_bytes);
    }

  return return_vals;
}

static LigmaValueArray *
image_set_simulation_profile_invoker (LigmaProcedure         *procedure,
                                      Ligma                  *ligma,
                                      LigmaContext           *context,
                                      LigmaProgress          *progress,
                                      const LigmaValueArray  *args,
                                      GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  gint num_bytes;
  const guint8 *color_profile;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  num_bytes = g_value_get_int (ligma_value_array_index (args, 1));
  color_profile = ligma_value_get_uint8_array (ligma_value_array_index (args, 2));

  if (success)
    {
      if (color_profile)
        {
          LigmaColorProfile *profile;

          profile = ligma_color_profile_new_from_icc_profile (color_profile,
                                                             num_bytes,
                                                             error);

          if (profile)
            {
              ligma_image_set_simulation_profile (image, profile);
              g_object_unref (profile);
            }
          else
            {
              success = FALSE;
            }
        }
      else
        {
          ligma_image_set_simulation_profile (image, NULL);
        }
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_set_simulation_profile_from_file_invoker (LigmaProcedure         *procedure,
                                                Ligma                  *ligma,
                                                LigmaContext           *context,
                                                LigmaProgress          *progress,
                                                const LigmaValueArray  *args,
                                                GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  GFile *file;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  file = g_value_get_object (ligma_value_array_index (args, 1));

  if (success)
    {
      if (file)
        {
          LigmaColorProfile *profile;

          profile = ligma_color_profile_new_from_file (file, error);

          if (profile)
            {
              ligma_image_set_simulation_profile (image, profile);
              g_object_unref (profile);
            }
          else
            {
              success = FALSE;
            }
        }
      else
        {
          ligma_image_set_simulation_profile (image, NULL);
        }
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_get_simulation_intent_invoker (LigmaProcedure         *procedure,
                                     Ligma                  *ligma,
                                     LigmaContext           *context,
                                     LigmaProgress          *progress,
                                     const LigmaValueArray  *args,
                                     GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gint intent = 0;

  image = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      intent = ligma_image_get_simulation_intent (image);
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_enum (ligma_value_array_index (return_vals, 1), intent);

  return return_vals;
}

static LigmaValueArray *
image_set_simulation_intent_invoker (LigmaProcedure         *procedure,
                                     Ligma                  *ligma,
                                     LigmaContext           *context,
                                     LigmaProgress          *progress,
                                     const LigmaValueArray  *args,
                                     GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  gint intent;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  intent = g_value_get_enum (ligma_value_array_index (args, 1));

  if (success)
    {
      ligma_image_set_simulation_intent (image, intent);
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_get_simulation_bpc_invoker (LigmaProcedure         *procedure,
                                  Ligma                  *ligma,
                                  LigmaContext           *context,
                                  LigmaProgress          *progress,
                                  const LigmaValueArray  *args,
                                  GError               **error)
{
  gboolean success = TRUE;
  LigmaValueArray *return_vals;
  LigmaImage *image;
  gboolean bpc = FALSE;

  image = g_value_get_object (ligma_value_array_index (args, 0));

  if (success)
    {
      bpc = ligma_image_get_simulation_bpc (image);
    }

  return_vals = ligma_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_boolean (ligma_value_array_index (return_vals, 1), bpc);

  return return_vals;
}

static LigmaValueArray *
image_set_simulation_bpc_invoker (LigmaProcedure         *procedure,
                                  Ligma                  *ligma,
                                  LigmaContext           *context,
                                  LigmaProgress          *progress,
                                  const LigmaValueArray  *args,
                                  GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  gboolean bpc;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  bpc = g_value_get_boolean (ligma_value_array_index (args, 1));

  if (success)
    {
      ligma_image_set_simulation_bpc (image, bpc);
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_convert_color_profile_invoker (LigmaProcedure         *procedure,
                                     Ligma                  *ligma,
                                     LigmaContext           *context,
                                     LigmaProgress          *progress,
                                     const LigmaValueArray  *args,
                                     GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  gint num_bytes;
  const guint8 *color_profile;
  gint intent;
  gboolean bpc;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  num_bytes = g_value_get_int (ligma_value_array_index (args, 1));
  color_profile = ligma_value_get_uint8_array (ligma_value_array_index (args, 2));
  intent = g_value_get_enum (ligma_value_array_index (args, 3));
  bpc = g_value_get_boolean (ligma_value_array_index (args, 4));

  if (success)
    {
      if (color_profile)
        {
          LigmaColorProfile *profile;

          profile = ligma_color_profile_new_from_icc_profile (color_profile,
                                                             num_bytes,
                                                             error);

          if (profile)
            {
              success = ligma_image_convert_color_profile (image, profile,
                                                          intent, bpc,
                                                          progress, error);
              g_object_unref (profile);
            }
          else
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static LigmaValueArray *
image_convert_color_profile_from_file_invoker (LigmaProcedure         *procedure,
                                               Ligma                  *ligma,
                                               LigmaContext           *context,
                                               LigmaProgress          *progress,
                                               const LigmaValueArray  *args,
                                               GError               **error)
{
  gboolean success = TRUE;
  LigmaImage *image;
  GFile *file;
  gint intent;
  gboolean bpc;

  image = g_value_get_object (ligma_value_array_index (args, 0));
  file = g_value_get_object (ligma_value_array_index (args, 1));
  intent = g_value_get_enum (ligma_value_array_index (args, 2));
  bpc = g_value_get_boolean (ligma_value_array_index (args, 3));

  if (success)
    {
      if (file)
        {
          LigmaColorProfile *profile;

          profile = ligma_color_profile_new_from_file (file, error);

          if (profile)
            {
              success = ligma_image_convert_color_profile (image, profile,
                                                          intent, bpc,
                                                          progress, error);
              g_object_unref (profile);
            }
          else
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return ligma_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

void
register_image_color_profile_procs (LigmaPDB *pdb)
{
  LigmaProcedure *procedure;

  /*
   * ligma-image-get-color-profile
   */
  procedure = ligma_procedure_new (image_get_color_profile_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-get-color-profile");
  ligma_procedure_set_static_help (procedure,
                                  "Returns the image's color profile",
                                  "This procedure returns the image's color profile, or NULL if the image has no color profile assigned.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Michael Natterer <mitch@ligma.org>",
                                         "Michael Natterer",
                                         "2015");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_int ("num-bytes",
                                                     "num bytes",
                                                     "Number of bytes in the color_profile array",
                                                     0, G_MAXINT32, 0,
                                                     LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_uint8_array ("profile-data",
                                                                "profile data",
                                                                "The image's serialized color profile.",
                                                                LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-get-effective-color-profile
   */
  procedure = ligma_procedure_new (image_get_effective_color_profile_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-get-effective-color-profile");
  ligma_procedure_set_static_help (procedure,
                                  "Returns the color profile that is used for the image",
                                  "This procedure returns the color profile that is actually used for this image, which is the profile returned by 'ligma-image-get-color-profile' if the image has a profile assigned, or a generated default RGB or grayscale profile, according to the image's type.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Michael Natterer <mitch@ligma.org>",
                                         "Michael Natterer",
                                         "2015");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_int ("num-bytes",
                                                     "num bytes",
                                                     "Number of bytes in the color_profile array",
                                                     0, G_MAXINT32, 0,
                                                     LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_uint8_array ("profile-data",
                                                                "profile data",
                                                                "The image's serialized color profile.",
                                                                LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-set-color-profile
   */
  procedure = ligma_procedure_new (image_set_color_profile_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-set-color-profile");
  ligma_procedure_set_static_help (procedure,
                                  "Sets the image's color profile",
                                  "This procedure sets the image's color profile, or unsets it if NULL is passed as 'color_profile'. This procedure does no color conversion. However, it will change the pixel format of all layers to contain the babl space matching the profile. You must call this procedure before adding layers to the image.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Michael Natterer <mitch@ligma.org>",
                                         "Michael Natterer",
                                         "2015");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("num-bytes",
                                                 "num bytes",
                                                 "Number of bytes in the color_profile array",
                                                 0, G_MAXINT32, 0,
                                                 LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_uint8_array ("color-profile",
                                                            "color profile",
                                                            "The new serialized color profile",
                                                            LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-set-color-profile-from-file
   */
  procedure = ligma_procedure_new (image_set_color_profile_from_file_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-set-color-profile-from-file");
  ligma_procedure_set_static_help (procedure,
                                  "Sets the image's color profile from an ICC file",
                                  "This procedure sets the image's color profile from a file containing an ICC profile, or unsets it if NULL is passed as 'file'. This procedure does no color conversion. However, it will change the pixel format of all layers to contain the babl space matching the profile. You must call this procedure before adding layers to the image.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Michael Natterer <mitch@ligma.org>",
                                         "Michael Natterer",
                                         "2015");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_object ("file",
                                                    "file",
                                                    "The file containing the new color profile",
                                                    G_TYPE_FILE,
                                                    LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-get-simulation-profile
   */
  procedure = ligma_procedure_new (image_get_simulation_profile_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-get-simulation-profile");
  ligma_procedure_set_static_help (procedure,
                                  "Returns the image's simulation color profile",
                                  "This procedure returns the image's simulation color profile, or NULL if the image has no simulation color profile assigned.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_int ("num-bytes",
                                                     "num bytes",
                                                     "Number of bytes in the color_profile array",
                                                     0, G_MAXINT32, 0,
                                                     LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   ligma_param_spec_uint8_array ("profile-data",
                                                                "profile data",
                                                                "The image's serialized simulation color profile.",
                                                                LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-set-simulation-profile
   */
  procedure = ligma_procedure_new (image_set_simulation_profile_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-set-simulation-profile");
  ligma_procedure_set_static_help (procedure,
                                  "Sets the image's simulation color profile",
                                  "This procedure sets the image's simulation color profile, or unsets it if NULL is passed as 'color_profile'. This procedure does no color conversion.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("num-bytes",
                                                 "num bytes",
                                                 "Number of bytes in the color_profile array",
                                                 0, G_MAXINT32, 0,
                                                 LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_uint8_array ("color-profile",
                                                            "color profile",
                                                            "The new serialized simulation color profile",
                                                            LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-set-simulation-profile-from-file
   */
  procedure = ligma_procedure_new (image_set_simulation_profile_from_file_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-set-simulation-profile-from-file");
  ligma_procedure_set_static_help (procedure,
                                  "Sets the image's simulation color profile from an ICC file",
                                  "This procedure sets the image's simulation color profile from a file containing an ICC profile, or unsets it if NULL is passed as 'file'. This procedure does no color conversion.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_object ("file",
                                                    "file",
                                                    "The file containing the new simulation color profile",
                                                    G_TYPE_FILE,
                                                    LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-get-simulation-intent
   */
  procedure = ligma_procedure_new (image_get_simulation_intent_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-get-simulation-intent");
  ligma_procedure_set_static_help (procedure,
                                  "Returns the image's simulation rendering intent",
                                  "This procedure returns the image's simulation rendering intent.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_enum ("intent",
                                                      "intent",
                                                      "The image's simulation rendering intent.",
                                                      LIGMA_TYPE_COLOR_RENDERING_INTENT,
                                                      LIGMA_COLOR_RENDERING_INTENT_PERCEPTUAL,
                                                      LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-set-simulation-intent
   */
  procedure = ligma_procedure_new (image_set_simulation_intent_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-set-simulation-intent");
  ligma_procedure_set_static_help (procedure,
                                  "Sets the image's simulation rendering intent",
                                  "This procedure sets the image's simulation rendering intent.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_enum ("intent",
                                                  "intent",
                                                  "A LigmaColorRenderingIntent",
                                                  LIGMA_TYPE_COLOR_RENDERING_INTENT,
                                                  LIGMA_COLOR_RENDERING_INTENT_PERCEPTUAL,
                                                  LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-get-simulation-bpc
   */
  procedure = ligma_procedure_new (image_get_simulation_bpc_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-get-simulation-bpc");
  ligma_procedure_set_static_help (procedure,
                                  "Returns whether the image has Black Point Compensation enabled for its simulation",
                                  "This procedure returns whether the image has Black Point Compensation enabled for its simulation",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_return_value (procedure,
                                   g_param_spec_boolean ("bpc",
                                                         "bpc",
                                                         "The Black Point Compensation status.",
                                                         FALSE,
                                                         LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-set-simulation-bpc
   */
  procedure = ligma_procedure_new (image_set_simulation_bpc_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-set-simulation-bpc");
  ligma_procedure_set_static_help (procedure,
                                  "Sets whether the image has Black Point Compensation enabled for its simulation",
                                  "This procedure whether the image has Black Point Compensation enabled for its simulation",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Alex S.",
                                         "Alex S.",
                                         "2022");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_boolean ("bpc",
                                                     "bpc",
                                                     "The Black Point Compensation status.",
                                                     FALSE,
                                                     LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-convert-color-profile
   */
  procedure = ligma_procedure_new (image_convert_color_profile_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-convert-color-profile");
  ligma_procedure_set_static_help (procedure,
                                  "Convert the image's layers to a color profile",
                                  "This procedure converts from the image's color profile (or the default RGB or grayscale profile if none is set) to the given color profile. Only RGB and grayscale color profiles are accepted, according to the image's type.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Michael Natterer <mitch@ligma.org>",
                                         "Michael Natterer",
                                         "2015");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_int ("num-bytes",
                                                 "num bytes",
                                                 "Number of bytes in the color_profile array",
                                                 0, G_MAXINT32, 0,
                                                 LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_uint8_array ("color-profile",
                                                            "color profile",
                                                            "The serialized color profile",
                                                            LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_enum ("intent",
                                                  "intent",
                                                  "Rendering intent",
                                                  LIGMA_TYPE_COLOR_RENDERING_INTENT,
                                                  LIGMA_COLOR_RENDERING_INTENT_PERCEPTUAL,
                                                  LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_boolean ("bpc",
                                                     "bpc",
                                                     "Black point compensation",
                                                     FALSE,
                                                     LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * ligma-image-convert-color-profile-from-file
   */
  procedure = ligma_procedure_new (image_convert_color_profile_from_file_invoker);
  ligma_object_set_static_name (LIGMA_OBJECT (procedure),
                               "ligma-image-convert-color-profile-from-file");
  ligma_procedure_set_static_help (procedure,
                                  "Convert the image's layers to a color profile",
                                  "This procedure converts from the image's color profile (or the default RGB or grayscale profile if none is set) to an ICC profile specified by 'file'. Only RGB and grayscale color profiles are accepted, according to the image's type.",
                                  NULL);
  ligma_procedure_set_static_attribution (procedure,
                                         "Michael Natterer <mitch@ligma.org>",
                                         "Michael Natterer",
                                         "2015");
  ligma_procedure_add_argument (procedure,
                               ligma_param_spec_image ("image",
                                                      "image",
                                                      "The image",
                                                      FALSE,
                                                      LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_object ("file",
                                                    "file",
                                                    "The file containing the new color profile",
                                                    G_TYPE_FILE,
                                                    LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_enum ("intent",
                                                  "intent",
                                                  "Rendering intent",
                                                  LIGMA_TYPE_COLOR_RENDERING_INTENT,
                                                  LIGMA_COLOR_RENDERING_INTENT_PERCEPTUAL,
                                                  LIGMA_PARAM_READWRITE));
  ligma_procedure_add_argument (procedure,
                               g_param_spec_boolean ("bpc",
                                                     "bpc",
                                                     "Black point compensation",
                                                     FALSE,
                                                     LIGMA_PARAM_READWRITE));
  ligma_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);
}
